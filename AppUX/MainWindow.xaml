<Window x:Class="AppUX.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AppUX"
        xmlns:methods="clr-namespace:AppUX.Animations.Methods"
        mc:Ignorable="d"
        Icon="./microsoft_Excel.ico"
        Title="ProcessingOfGia"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Language="RU-ru"
        Height="450" 
        Width="800"
        MinHeight="600"
        MinWidth="1080">
    <Grid Style="{DynamicResource GridStyle}">

        <Menu HorizontalAlignment="Left" VerticalAlignment="Top" Width="75" Height="20" >

            <MenuItem Header="{DynamicResource file}" Height="20" Width="75" Padding="20, 0, 0, 2" Template="{DynamicResource MenuItemTemplate1}">

                <MenuItem x:Name="OpenButton"  Command="{Binding Path=OpenCommand}" Header="{DynamicResource open}"    Template="{DynamicResource MenuItemTemplate2}"></MenuItem>
                <MenuItem x:Name="CloseButton" Command="{Binding Path=GridClearCommand}" Header="{DynamicResource close}"  Template="{DynamicResource MenuItemTemplate2}"></MenuItem>
                <Separator />
                <MenuItem x:Name="SettingsButton" Click="SettingsButton_Click" Header="{DynamicResource settings}"    Template="{DynamicResource MenuItemTemplate2}"></MenuItem>

            </MenuItem>

        </Menu>

        <Button x:Name="FilterButton" Style="{DynamicResource DefaultButton}" Click="FilterOpenButton_Click" Content="{DynamicResource filter}" HorizontalAlignment="Left" Width="75" Height="20" VerticalAlignment="Top" Margin="75,0,0,0"/>
        <DataGrid x:Name="ExcelTable" AutoGeneratingColumn="OnAutoGeneratingColumn" Style="{DynamicResource DataGridStyle}" Margin="0,20,0,25" ItemsSource="{Binding Path=ExcelTable, Mode=TwoWay}" BorderBrush="{x:Null}"/>

        <Grid Background="#FF2E7D32" Height="25" VerticalAlignment="Bottom" >

            <Label x:Name="PathLabel" Content="{Binding Path=FilePath}" Background="#FF2E7D32" Foreground="WhiteSmoke" FontFamily="Segoe UI" FontSize="12" Height="25" VerticalAlignment="Bottom" HorizontalAlignment="Left" Width="300"/>

            <Button x:Name="SaveButton" Style="{DynamicResource DefaultButton}" Command="{Binding Path=SaveCommand}" Content="{DynamicResource save}" HorizontalAlignment="Right" Height="25" Width="75" Foreground="WhiteSmoke"/>

        </Grid>

        <Grid x:Name="Filter" Background="#7f000000" Opacity="0" Visibility="Hidden">

            <Grid Style="{DynamicResource GridStyle}" HorizontalAlignment="Center" VerticalAlignment="Center" Width="800" Height="330">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="700"/>
                        <ColumnDefinition Width="80"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Style="{DynamicResource GroupBoxStyle}" Margin="13,13,13,0" Header="{DynamicResource filter}" VerticalAlignment="Top" Height="135" Padding="12">
                        <Grid VerticalAlignment="Bottom" Height="115" Margin="-172,-39,-172,-71">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Style="{DynamicResource TextBlockStyle}" Text="{DynamicResource column}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="50, 0, 0, 0"/>
                            <ComboBox x:Name="SelectColumnBox" Grid.Column="0" ItemsSource="{Binding Path=ComboBoxContent}" SelectedValue="{Binding Path=SelectedItem, Mode=TwoWay}" FontFamily="Segoe UI" FontSize="9"  Style="{DynamicResource HeaderComboBox}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0, 0, 25, 0" Width="200"/>

                            <TextBlock Grid.Column="1" Style="{DynamicResource TextBlockStyle}" Text="{DynamicResource filter}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="25, 0, 0, 0"/>
                            <TextBox x:Name="FilterBox" Text="{Binding Path=Filter, Mode=TwoWay}" TextChanged="Filter_TextChanged" Height="17" TextWrapping="Wrap" Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0, 0, 60, 0" Width="200" MaxLength="25"/>
                        </Grid>
                    </GroupBox>

                    <GroupBox Style="{DynamicResource GroupBoxStyle}" Margin="13,160,13,0" Header="{DynamicResource sort}" VerticalAlignment="Top" Height="135" Padding="12">
                        <Grid VerticalAlignment="Bottom" Height="120" Margin="-172,-39,-172,-71">
                            <ComboBox ItemsSource="{Binding Path=ComboBoxContent}" SelectedValue="{Binding Path=SelectedItem2, Mode=TwoWay}" FontFamily="Segoe UI" FontSize="9" Style="{DynamicResource HeaderComboBox}" VerticalAlignment="Top" HorizontalAlignment="Center" Width="200" Margin="0, 5, 0, 0"/>
                            <Grid Margin="0,25,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*"/>
                                    <ColumnDefinition Width="1*"/>
                                </Grid.ColumnDefinitions>

                                <RadioButton Command="{Binding SortTableCommand}" Grid.Column="0" IsChecked="{Binding Path=ModeArray[0], Mode=TwoWay}" x:Name="ExcelFile" Style="{DynamicResource DefaultRadioButton}" Margin="10">
                                    <StackPanel>
                                        <Viewbox Stretch="Uniform" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Height="45" Width="60">
                                            <Canvas Height="256" Width="256">
                                                <Path Fill="Black" Data="M229.65527,173.65759l-39.999,39.99317c-.00928.00976-.02.01758-.0293.02685q-.26659.26367-.55615.50244c-.09277.07618-.19092.14258-.28613.21387-.11377.085-.2251.17334-.34326.25244-.11329.07569-.23047.14112-.34668.21045-.10743.06446-.21338.13233-.32422.1919-.11817.063-.23975.11621-.35987.17334-.11669.05468-.231.11279-.35009.16211-.1167.04834-.23584.0874-.3545.12988-.12744.0459-.2539.09473-.38427.13476-.11866.03565-.23877.06153-.35791.0918-.13379.03369-.26563.07129-.40137.09815-.13867.02734-.27832.04345-.418.06347-.11865.01709-.23535.03955-.35547.05127-.2622.02588-.52539.04-.78906.04s-.52686-.01416-.78955-.04c-.11865-.01172-.23389-.03369-.35108-.05078-.14111-.02-.28222-.03662-.42236-.06445-.13428-.02637-.26416-.06348-.396-.09668-.12159-.03028-.24366-.05664-.36329-.09326-.1289-.03907-.25293-.08741-.3789-.13233-.12012-.043-.2417-.083-.36035-.13183-.1167-.04834-.228-.105-.3418-.1587-.123-.0581-.24756-.11279-.36865-.17773-.10694-.05713-.2085-.12256-.312-.18408-.12012-.07178-.24219-.14014-.35938-.21826-.1123-.0752-.21777-.15918-.32617-.23975-.10108-.07519-.2041-.146-.30274-.22656-.1748-.14356-.3413-.29737-.50341-.45508-.02637-.02539-.05518-.04736-.08106-.07324l-40-40a8.00036,8.00036,0,0,1,11.314-11.31446L176,188.67957v-76.686a8,8,0,0,1,16,0V188.682l26.34277-26.33887a7.99983,7.99983,0,1,1,11.3125,11.31445ZM119.999,119.99353H48a8,8,0,0,0,0,16h71.999a8,8,0,1,0,0-16Zm-71.999-48H183.999a8,8,0,0,0,0-16H48a8,8,0,1,0,0,16Zm56,112H48a8,8,0,0,0,0,16h56a8,8,0,0,0,0-16Z" />
                                            </Canvas>
                                        </Viewbox>
                                        <TextBlock Text="{DynamicResource ascending}" Width="110" TextAlignment="Center"/>
                                    </StackPanel>
                                </RadioButton>
                                <RadioButton Command="{Binding SortTableCommand}" Grid.Column="1" IsChecked="{Binding Path=ModeArray[1], Mode=TwoWay}" x:Name="WordFile" Style="{DynamicResource DefaultRadioButton}" Margin="10" Grid.ColumnSpan="2">
                                    <StackPanel>
                                        <Viewbox Stretch="Uniform" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Height="45" Width="60">
                                            <Canvas Height="256" Width="256">
                                                <Path Fill="Black" Data="M229.65625,93.643a7.99827,7.99827,0,0,1-11.31348.001L192,67.3053v76.68823a8,8,0,0,1-16,0V67.3075L149.65723,93.65076a8.00036,8.00036,0,0,1-11.314-11.31446l40-40c.02539-.02563.05371-.04687.07959-.07177.1626-.15869.32959-.3125.50537-.45679.09668-.07935.19824-.14844.29785-.22266.10987-.082.21729-.167.33106-.2434.11474-.07691.23389-.14356.352-.21387.10644-.06348.21045-.13037.32031-.18921.11719-.0625.23731-.11548.35645-.17163.11767-.05591.2334-.1145.35449-.16455.11279-.04663.22754-.084.3418-.12525.13232-.04785.26367-.09838.39892-.1394.10987-.0332.22217-.05737.333-.08569.1416-.03638.28223-.07544.42676-.104.12256-.02417.24658-.03808.37012-.05664.13476-.02.26757-.04492.40429-.05835.2041-.02.40821-.02661.61279-.03076.05762-.00146.11377-.00879.17188-.00879.06152,0,.12109.00781.18213.00928.20068.00439.40137.01074.60156.03027.14014.01367.27686.03906.415.06006.12012.01807.24023.03125.35889.05469.14892.02929.293.06958.43847.10693.10694.02735.21485.05054.3208.08252.14014.04248.27588.09448.4126.14429.10938.03955.21973.07519.32715.11987.12647.05225.24805.11353.37109.17188.11377.0542.22852.10424.33985.16406.11621.062.22656.13257.33935.20019.11182.0669.22461.12989.3335.20264.12207.08154.23682.17212.354.26025.0918.06885.186.13257.27539.20606.19385.15893.37989.32764.55811.50391.00928.00927.01953.0166.02832.02587l39.999,39.99317A7.99959,7.99959,0,0,1,229.65625,93.643ZM48,135.99353h71.999a8,8,0,1,0,0-16H48a8,8,0,0,0,0,16Zm0-64h55.999a8,8,0,0,0,0-16H48a8,8,0,1,0,0,16Zm135.999,112H48a8,8,0,0,0,0,16H183.999a8,8,0,0,0,0-16Z" />
                                            </Canvas>
                                        </Viewbox>
                                        <TextBlock Text="{DynamicResource descending}" Width="110" TextAlignment="Center"/>
                                    </StackPanel>
                                </RadioButton>
                            </Grid>
                        </Grid>
                    </GroupBox>

                    <StackPanel Margin="0, 5, 0, 0" Grid.Column="1" Grid.Row="0">
                        <Button Command="{Binding ClearFilterCommand}" x:Name="ClearButton" Content="{DynamicResource clear}" Style="{DynamicResource RoundedButton}"/>
                        <Button Click="FilterBackButton_Click" x:Name="BackButton" Content="{DynamicResource back}" Style="{DynamicResource RoundedButton}" Margin="0, 7, 0, 0"/>
                    </StackPanel>
                </Grid>
            </Grid>

        </Grid>
    </Grid>
</Window>
